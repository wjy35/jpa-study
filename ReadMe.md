># JPA?

## JPA (Java Persistence Api)

Java에서 Object Relation Mapping (ORM) 기술 표준으로 사용되는 interface 모음

다음의 내용을 포함
- javax.persistance 패키지로 정의 된 API 그 자체
- JPQL (Java Persistence Query Language)
- Object/Relation Meta Data

[Jakarta Persistence 3.1 JavaDoc](https://jakarta.ee/specifications/persistence/3.1/apidocs/jakarta.persistence/jakarta/persistence/package-summary.html)

## Hibernate ORM

JPA 를 구현한 ORM Framework 

[Hibernate ORM](https://hibernate.org/orm/documentation/6.2/)
[Hibernate Java Doc](https://docs.jboss.org/hibernate/orm/6.2/javadocs/)

## Spring Data JPA

Spring 에서 JPA를 사용하기 편하도록 만든 Module

![jpa vs hibernate vs spring data jpa](image/img1.png)
___

># JPA 

## ORM Mapping

### ORM Mapping?
OOP의 Object 와 Relation DataBase 의 Data를 자동으로 연결해주는 것 <br>
JPA에서는 @Entity를 통해 Entity 를 지원

### Entity

OR Mapping 에 이용되는 Object <br>

### Entity Mapping

[예제]()

#### @Entity
class 가 entity 임을 지정
- 사용하지 않을 경우 class는 object 생성시 entity로 인식되지 않아 IllegalArgumentException 을 발생시킴

```java
@Documented
@Target(TYPE)
@Retention(RUNTIME)
public @interface Entity {

    /**
     * (Optional) The entity name. Defaults to the unqualified
     * name of the entity class. This name is used to refer to the
     * entity in queries. The name must not be a reserved literal
     * in the Jakarta Persistence query language.
     */
    String name() default "";
}
```

#### @Id
Entity의 Primary Key를 지정
- @Entity class 내부에서 required
- 아래에 나와있는 Type 중 하나에만 사용해야 함

```java
/**
 * Specifies the primary key of an entity.
 * The field or property to which the <code>Id</code> annotation is applied 
 * should be one of the following types: any Java primitive type; 
 * any primitive wrapper type; 
 * 
 * String
 * java.util.Date
 * java.sql.Date
 * java.math.BigDecimal
 * java.math.BigInteger
 *
 * <p>The mapped column for the primary key of the entity is assumed 
 * to be the primary key of the primary table. If no <code>Column</code> annotation 
 * is specified, the primary key column name is assumed to be the name 
 * of the primary key property or field.
 * 
 * @since 1.0
 */
@Target({METHOD, FIELD})
@Retention(RUNTIME)

public @interface Id {}
```

#### @Column
entity class의 feild와 RDB의 Column을 mapping 할 때 사용됨
- default는 class feild name 과 일치하는 column 을 mapping
- 그 외에 다양한 옵션이 있음

```java

@Target({METHOD, FIELD}) 
@Retention(RUNTIME)
public @interface Column {

    /**
     * (Optional) The name of the column. Defaults to 
     * the property or field name.
     */
    String name() default "";

    /**
     * (Optional) Whether the column is a unique key.  This is a 
     * shortcut for the <code>UniqueConstraint</code> annotation at the table 
     * level and is useful for when the unique key constraint 
     * corresponds to only a single column. This constraint applies 
     * in addition to any constraint entailed by primary key mapping and 
     * to constraints specified at the table level.
     */
    boolean unique() default false;

    /**
     * (Optional) Whether the database column is nullable.
     */
    boolean nullable() default true;

    /**
     * (Optional) Whether the column is included in SQL INSERT 
     * statements generated by the persistence provider.
     */
    boolean insertable() default true;

    /**
     * (Optional) Whether the column is included in SQL UPDATE 
     * statements generated by the persistence provider.
     */
    boolean updatable() default true;

    /**
     * (Optional) The SQL fragment that is used when 
     * generating the DDL for the column.
     * <p> Defaults to the generated SQL to create a
     * column of the inferred type.
     */
    String columnDefinition() default "";

    /**
     * (Optional) The name of the table that contains the column. 
     * If absent the column is assumed to be in the primary table.
     */
    String table() default "";

    /**
     * (Optional) The column length. (Applies only if a
     * string-valued column is used.)
     */
    int length() default 255;

    /**
     * (Optional) The precision for a decimal (exact numeric) 
     * column. (Applies only if a decimal column is used.)
     * Value must be set by developer if used when generating 
     * the DDL for the column.
     */
    int precision() default 0;

    /**
     * (Optional) The scale for a decimal (exact numeric) column. 
     * (Applies only if a decimal column is used.)
     */
    int scale() default 0;
}
```

#### @GeneratedValue
primary key 의 값 생성 전략을 제공
- GenerationType.IDENTITY 등을 상황에 맞춰 사용함
- auto increment 등을 위해 사용함

```java

/**
 * Provides for the specification of generation strategies for the
 * values of primary keys. 
 *
 * <p> The <code>GeneratedValue</code> annotation
 * may be applied to a primary key property or field of an entity or
 * The use of the <code>GeneratedValue</code> annotation is only
 * required to be supported for simple primary keys.  Use of the
 * <code>GeneratedValue</code> annotation is not supported for derived
 * primary keys.
 *
 * @since 1.0
 */
@Target({METHOD, FIELD})
@Retention(RUNTIME)

public @interface GeneratedValue {

    /**
     * (Optional) The primary key generation strategy
     * that the persistence provider must use to
     * generate the annotated entity primary key.
     */
    GenerationType strategy() default AUTO;

    /**
     * (Optional) The name of the primary key generator
     * <p> Defaults to the id generator supplied by persistence provider.
     */
    String generator() default "";
}

```

## Persistence Context

### Persistence Context?

### Entity Life Cycle



### EntityManager



># Hibernate

## persistence.xml

## EntityManagerFactory

___











